

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>polictf2015 - Page 1 - &lt;/pwntester&gt;</title>
    <meta name="description" content="">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="../../assets/favicon.png?v=d47df0f104">

    <link rel="stylesheet" type="text/css" href="../../assets/css/screen.css?v=d47df0f104">
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">

    <script type="text/javascript" src="../../assets/js/jquery-1.11.1.min.js?v=d47df0f104"></script>
    <script type="text/javascript" src="../../assets/js/jquery.fitvids.js?v=d47df0f104"></script>
    <script type="text/javascript" src="../../assets/js/moment.js?v=d47df0f104"></script>
    <script type="text/javascript" src="../../assets/js/handlebars.js?v=d47df0f104"></script>
    <script type="text/javascript" src="../../assets/js/jquery.tapirus.js?v=d47df0f104"></script> 
    <script type="text/javascript" src="../../assets/js/index.js?v=d47df0f104"></script>


    <link rel="canonical" href="http://www.pwntester.com/tag/polictf2015/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    
    <meta property="og:site_name" content="&lt;/pwntester&gt;">
    <meta property="og:type" content="website">
    <meta property="og:title" content="polictf2015 - Page 1 - &lt;/pwntester&gt;">
    <meta property="og:url" content="http://www.pwntester.com/tag/polictf2015/">
    <meta property="article:modified_time" content="2015-07-12T09:53:54.000Z">
    <meta name="twitter:card" content="summary">
    <meta name="twitter:title" content="polictf2015 - Page 1 - &lt;/pwntester&gt;">
    <meta name="twitter:url" content="http://www.pwntester.com/tag/polictf2015/">
    
    <script type="application/ld+json">
{
    "@context": "https://schema.org",
    "@type": "Series",
    "publisher": {
        "@type": "Organization",
        "name": "&lt;/pwntester&gt;",
        "logo": "http://www.pwntester.com/content/images/2014/May/rooted.jpeg"
    },
    "url": "http://www.pwntester.com/tag/polictf2015/",
    "name": "polictf2015",
    "mainEntityOfPage": {
        "@type": "WebPage",
        "@id": "http://www.pwntester.com"
    }
}
    </script>

    <meta name="generator" content="Ghost 0.11">
    <link rel="alternate" type="application/rss+xml" title="&lt;/pwntester&gt;" href="http://www.pwntester.com/rss/">

    <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="../../assets/css/prism.css?v=d47df0f104">

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-49973078-2', 'pwntester.com');
  ga('send', 'pageview');

</script></head>

<body class="tag-template tag-polictf2015">

    <div id="sidebar">
        <div id="sidebar-content" class="inner">
            <a class="blog-logo" href="http://www.pwntester.com"><img src="../../content/images/2014/May/rooted.jpeg" alt="Blog Logo"></a>
            <h2 class="blog-title"><a href="http://www.pwntester.com">&lt;/pwntester&gt;</a>
            <h3 class="blog-description"></h3></h2>

            <!--form id="search">
                <input id="search-field" placeholder="Search"/>
            </form-->
            <form id="search">  
                <input id="search-field" type="search" placeholder="Search">
            </form>  

            <div id="sidebar-links">
                <ul id="subscription-links">
                    <li><a target="_blank" href="http://www.pwntester.com/rss/"><i class="fa fa-rss"></i> Subscribe via RSS</a></li>
                    <!-- No support yet
                    <li><a target="_blank" href=" "><i class="fa fa-envelope"></i> Subscribe via email<a></li>
                    -->
                </ul>
                <ul id="sidebar-internal">
                    <!-- For 'About' and other pages -->
                </ul>
                <ul id="sidebar-external">
                    <li class="external-link"><a href="https://github.com/pwntester"><i class="fa fa-github"></i> GitHub</a></li>
<li class="external-link"><a href="http://www.linkedin.com/in/alvaroms"><i class="fa fa-linkedin"></i> LinkedIn</a></li>
<li class="external-link"><a href="https://twitter.com/pwntester"><i class="fa fa-twitter"></i> Twitter</a></li>
<li class="external-link"><a target="_blank" href="mailto:alvaro@pwntester.com"><i class="fa fa-envelope"></i> Contact</a></li>
                </ul>
            </div>

            <footer class="site-footer">
                <section class="copyright">© 2017 <a href="mailto:alvaro@pwntester.com">Alvaro Muñoz</a> • All rights reserved.</section>
            </footer>
        </div>
    </div>

    <main>
        <section id="results"></section>
        

<header class="tag-archive-header">
    <h4><i class="fa fa-tag"></i><span class="tag-archive-header-name">polictf2015</span></h4>
</header>


<article class="post tag-polictf2015">
    <header class="post-header">
        <span class="post-meta"><time datetime="2015-07-12">12 Jul 2015</time> on <a href="index.html">polictf2015</a></span>
        <h2 class="post-title"><a href="../../blog/2015/07/12/polictf-2015-web350-magic-chall/">PoliCTF 2015. Web350 - Magic Chall</a></h2>

    </header>
    <section class="post-content">
        <p>We are presented with a web that allows us to register an account, then log in and be surprised with random disturbing videos xDDD. The web uses a <code>page</code> parameter to reference and include other pages and its vulnerable to LFI. For example, instead of going to <code>http://magic.polictf.it/magic_things.php</code> we can include it in <code>index.php</code> with <code>http://magic.polictf.it/index.php?page=magic_things</code>. So it seems that we can include any file ending in <code>.php</code> since we cannot seem to discard the extension using a null byte. <br>
First thing to try in a php application are the php filters. So we can try to read the source code by using the base64 filter: <br>
<code>http://magic.polictf.it/index.php?page=php://filter/convert.base64-encode/resource=index</code> and voila, the site returns us a base64 version of <code>index.php</code> source code:
<img src="../../content/images/2015/07/Screen-Shot-2015-07-11-at-17-17-27.png" alt="">
From here we procedeed to collect and read all source code and include files. Interesting things:</p>

<p>1 - Running any method on a Magic instance will print the flag: <br>
<img src="../../content/images/2015/07/Screen-Shot-2015-07-11-at-17-19-17.png" alt=""></p>

<p>2 - Log files are written to <code>$_SERVER["DOCUMENT_ROOT"]."log/" . $host . "_" . $user-&gt;getSurname()</code> so we can control the extension by setting our Surename to <code>foo.php</code>. Also controlling the user Name, we can inject any arbitrary strings in the log. This smells like remote code execution. <br>
<img src="../../content/images/2015/07/Screen-Shot-2015-07-11-at-17-21-13.png" alt=""></p>

<p>Now, all we need to do is to register a user with Name: <code>&lt;?php (new Magic())-&gt;test();?&gt;</code> and surename: <code>foo.php</code> and then visit the log and read the flag: <br>
<img src="../../content/images/2015/07/magic.png" alt=""></p>
    </section>
</article>


<article class="post tag-polictf2015">
    <header class="post-header">
        <span class="post-meta"><time datetime="2015-07-12">12 Jul 2015</time> on <a href="index.html">polictf2015</a></span>
        <h2 class="post-title"><a href="../../blog/2015/07/12/polictf-150/">PoliCTF 2015. Web150 - John The Referee</a></h2>

    </header>
    <section class="post-content">
        <p>We are presented with an online shop to buy Referee t-shirts: <br>
<img src="../../content/images/2015/07/ref1.png" alt=""></p>

<p>They have ids from 1-8 and then 10 (skipping 9).</p>

<p>There is also a search form that seems to escape some characters: <br>
<img src="../../content/images/2015/07/Screen-Shot-2015-07-11-at-16-52-35.png" alt=""></p>

<p>The search submission is somehow weird. Our search is submitted to server that returns a hash that we submit back to get the actual results. So either way the hash is an encrypted version of our search query that is decrypted and executed in the server or its a hash that represents the query and its mapped to our query in the server sesssion. Since there are no session cookies, it seems the former. So the process is the following, we submit our search query, it goes to the server where it gets escaped and encrypted. We get the encrypted value that we submit again for the server to decrypt and run the query. Since the query was escaped before encryption, there is no reason to not trust the decrypted query, right? someone said integrity? Ok, so all we have to do is submit our SQLi payload and replace the single quote with any arbitrary character. Then bit flip that character and send to server and see if any flipped queries result in a valid query with a single quote: <br>
<img src="../../content/images/2015/07/ref3.png" alt="">
<img src="../../content/images/2015/07/ref2-1.png" alt=""></p>

<p>Now we can take the encrypted query and replay it bitflipping the first character (<code>a</code>) until it or the next one (eg: cbc) becomes a single quote. We get the flag: <br>
<img src="../../content/images/2015/07/ref5.png" alt=""></p>
    </section>
</article>


<article class="post tag-polictf2015">
    <header class="post-header">
        <span class="post-meta"><time datetime="2015-07-12">12 Jul 2015</time> on <a href="index.html">polictf2015</a></span>
        <h2 class="post-title"><a href="../../blog/2015/07/12/picoctf-web100/">PoliCTF 2015. Web100 - John The Traveller</a></h2>

    </header>
    <section class="post-content">
        <blockquote>
  <p>Holidays are here! 
  But John still hasn't decided where to spend them and time is running out: flights are overbooked and prices are rising every second. 
  Fortunately, John just discovered a website where he can book last second flight to all the European capitals; 
  however, there's no time to waste, so he just grabs his suitcase and thanks to his new smartphone he looks the city of his choice up while rushing to the airport. 
  There he goes! Flight is booked so... hauskaa lomaa! 
  <img src="../../content/images/2015/07/Screen-Shot-2015-07-11-at-16-38-32.png" alt="">
  We are presented with a web that allows us to search for European capitals. It does seem injectable and theres nothing weird. The website returns a random number of flights with their costs in EURs and nothing else.</p>
</blockquote>

<p>After losing a lot of time with this one, we re-read the challange description once again and wondered about <code>hauskaa lomaa</code>. It turns out it means <code>Happy vacations</code> in Finish. So we checked flights to Helsinki and finally something out of the ordinary: the price was in <code>px</code> (pixels?) and there where always 6 results: <br>
<img src="../../content/images/2015/07/Screen-Shot-2015-07-11-at-16-43-10.png" alt=""></p>

<p>After having a look at the source code we realize that it contains a responsive UI and that the result table contains special classes: <br>
<img src="../../content/images/2015/07/Screen-Shot-2015-07-11-at-16-44-25.png" alt="">
<img src="../../content/images/2015/07/Screen-Shot-2015-07-11-at-16-45-02.png" alt=""></p>

<p>After loading the page on a device emulator with any of those widths, we get a QR: <br>
<img src="../../content/images/2015/07/Screen-Shot-2015-07-11-at-16-46-22.png" alt=""></p>

<p>Flag is: <code>flag{run_to_the_hills_run_for_your_life}</code></p>
    </section>
</article>


<article class="post tag-polictf2015">
    <header class="post-header">
        <span class="post-meta"><time datetime="2015-07-12">12 Jul 2015</time> on <a href="index.html">polictf2015</a></span>
        <h2 class="post-title"><a href="../../blog/2015/07/12/polictf-2015-crypto100-and-the-prophet-said/">PoliCTF 2015. Crypto100 - And the prophet said</a></h2>

    </header>
    <section class="post-content">
        <p>We are given a text that looks like base64, so we decode it and find a gzip file that contains a text file with 296 phrases from the bible. These phrases are repited so we assigned a random character to each line and got something like:</p>

<pre><code class="language-lang-raw">abccde fagh iajccbklb gh mbno bjho ghkpf gfq gpr fnogkl fd sngfb j cdkl rbhhjlb hd hfjfghfgih sgcc abct odu sgfa fab cbffbn vnbwubkigbhx yuf gpr kdf nbjcco lddz jf fajfx d0 fajfph bkdulae jajae gpr gk cdmb sgfa hgrtcb cdsbnijhb vcjlh sgfaduf htjibh jkz hfnjklb horydchx vcjl1cyafyllumvhokfyywsyd2  
</code></pre>

<p>Using a substitution decipher and a little bit of manual correction we get:</p>

<pre><code class="language-lang-raw">hello, this challenge is very easy isn't it? i'm trying to write a long message so statistics will help you with the letter frequencies. but i'm not really good at that. ok that's enough, ahah, i'm in love with simple lowercase flags without spaces and strange symbols. flag{lbhtbgguvfsyntbbqwbo}  
</code></pre>

<p>So flag is:</p>

<pre><code class="language-lang-raw">flag{lbhtbgguvfsyntbbqwbo}  
</code></pre>

<p>Which turns out to be anot valid flag. But the challange description said we need an extra step here, so we try to decode it using decoders such as ROT13 and voila:</p>

<pre><code class="language-lang-raw">flag{yougotthisflagoodjob}  
</code></pre>
    </section>
</article>


<article class="post tag-polictf2015">
    <header class="post-header">
        <span class="post-meta"><time datetime="2015-07-12">12 Jul 2015</time> on <a href="index.html">polictf2015</a></span>
        <h2 class="post-title"><a href="../../blog/2015/07/12/polictf-forensics100/">PoliCTF 2015. Forensics100 - John In The Middle</a></h2>

    </header>
    <section class="post-content">
        <p>We are given a pcap with the traffic generated to an old version of <code>http://polictf.it</code>. We can use NetworkMiner or similar tools to extract all files and compare them with the originals. <code>logo.png</code> differs from original and using StegoSolve we can find the secret flag: <br>
<img src="../../content/images/2015/07/Screen-Shot-2015-07-11-at-17-08-48.png" alt=""></p>
    </section>
</article>


<nav class="pagination" role="navigation">
    <span class="page-number">Page 1 of 1</span>
</nav>

    </main>

    <!-- You can safely delete this line if your theme does not require jQuery -->
<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

    <script src="../../assets/js/instantclick.min.js?v=d47df0f104" data-no-instant></script>
    <script data-no-instant>InstantClick.init();</script>
    <script data-no-instant>
        InstantClick.on('change', function() {
            prism_markdown();
            Prism.highlightAll();
        });
        InstantClick.init();
    </script>

    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'pwntester'; // required: replace example with your forum shortname
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>

    <script type="text/javascript" src="../../assets/js/prism-loader.js?v=d47df0f104"></script>
    <script type="text/javascript" src="../../assets/js/prism.js?v=d47df0f104"></script>

</body>

